<html>
<head>
    <title>OpenX Schema Datatype Integrity Utilities</title>
    <link rel="stylesheet" type="text/css" href="css/upgrade.css"/>

    <script type="text/javascript" src="schema.js"></script>
    <script type="text/javascript" src="../../lib/xajax/xajax_js/xajax.js"></script>
    <script type="text/javascript">
        window.setTimeout(function () { if (!xajaxLoaded) { alert('Error: the xajax Javascript file could not be included. Perhaps the URL is incorrect?\nURL: ../lib/xajax/xajax_js/xajax.js'); } }, 6000);
    </script>

</head>
<body onload="xajax_loadSchemaFile()">
<div class="tablediv">
    <h2>OpenX Schema Datatype Integrity Utilities</h2>
    <form name="frm_xml" action="schema.php" method="POST">
        <select id="xml_file" name="xml_files[]"" multiple="true"></select>
        <br />
        <!--button name="btn_schema_report" type="submit">check selected schema</button-->
        <button name="btn_schema_generate" type="submit">generate selected schemas</button>
    </form>
</div>
<div>
    <?php
    $i = count($aReport);
    if ($i>0)
    {
        echo "$i files generated<br />";
        foreach ($aReport as $file => $aTypes)
        {
            $n = count($aTypes[DATATYPE_TEXT]);
            if ($n>0)
            {
                echo "$n tables with wrong text types in $file<br />";
                foreach ($aTypes[DATATYPE_TEXT] as $table => $aFields)
                {
                    foreach ($aFields as $field => $string)
                    {
                        echo $table.'.'.$field.' => '.$string.'<br />';
                    }
                }
            }
            $n = count($aTypes[DATATYPE_MEDIUMINT]);
            if ($n>0)
            {
                echo "$n tables with wrong text types in $file<br />";
                foreach ($aTypes[DATATYPE_MEDIUMINT] as $table => $aFields)
                {
                    foreach ($aFields as $field => $string)
                    {
                        echo $table.'.'.$field.' => '.$string.'<br />';
                    }
                }
            }
            $n = count($aTypes[DATATYPE_DATETIME]);
            if ($n>0)
            {
                echo "$n tables with wrong date/time types in $file<br />";
                foreach ($aTypes[DATATYPE_DATETIME] as $table => $aFields)
                {
                    foreach ($aFields as $field => $string)
                    {
                        echo $table.'.'.$field.' => '.$string.'<br />';
                    }
                }
            }
        }
    }
    ?>
</div>
</body>
</html>