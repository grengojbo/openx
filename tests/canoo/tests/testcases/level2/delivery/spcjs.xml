<?xml version="1.0"?>
<!DOCTYPE project SYSTEM               "../../../../dtd/WebTest.dtd" [
  <!ENTITY config SYSTEM           "../../modules/config_openx.xml">
  <!ENTITY checkForErrors SYSTEM   "../../modules/errors.xml">
  <!ENTITY verifyHeaders SYSTEM    "../../modules/headers.xml">
]
>

<!--
  Test that page generate the JavaScript which contains the ad
  @TODO Check that returned JavaScript is valid
-->
<project name="OpenX delivery - spcjs.php" basedir="../.." default="main">
  <import file="../../modules/init.xml"/>
  <target name="canoo-test">
    <webtest name="${ant.project.name}">
      &config;
      <steps>
      	<ifStep>
      		<condition>
      				<verifyProperty 
      					name="${marketplace.enabled}"
      					propertyType="ant"
      					value="true"/>
      		</condition>	
      		<then>
		      	<invoke description="Invoke delivery file @{file}" url="/delivery_test/spcjs.html" />
		        &checkForErrors;
		
		      	<verifyElement text="spcjs" type="BODY"/>
		        <verifyText description="Check that it contains JavaScript" text="OA_output['1']" />
		        <!--verifyText description="Check that JS prints: 'html test banner'" regex="true" text="html test banner" /-->
      		</then>
      	</ifStep>
      </steps>
    </webtest>
  </target>

  <!-- clean cache, run a canoo test (without cache), and then run again (with cache) -->
  <target name="main" depends="test-cache" />

</project>